<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
	<title>Forge Bottom Sheet</title>

	<link rel="shortcut icon" href="https://cdn.forge.tylertech.com/favicon.ico" sizes="16x16" type="image/x-icon">
	<link rel="stylesheet" href="https://cdn.forge.tylertech.com/v1/css/tyler-font.css">
	<link rel="stylesheet" href="https://cdn.forge.tylertech.com/v1/css/tyler-icons-standard.css">

	<link rel="stylesheet" href="../../dist/styles/forge-core.css">
	<link rel="stylesheet" href="../../dist/styles/forge.css">
	<link rel="stylesheet" href="styles/styles.css">
	<style>
		#app {
			padding: 16px;
		}

		.card-container {
			display: grid;
			grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
			grid-column-gap: 16px;
		}

		.forge-card-footer {
			display: flex;
			flex-wrap: wrap;
			gap: 10px;
		}

		.forge-dialog__body {
			flex-grow: 1;
		}

		.forge-dialog__footer {
			gap: 10px;
		}

		[hidden] {
			display: none !important;
		}

		forge-bottom-sheet[fullscreen] .hidden-in-fullscreen {
			display: none !important;
		}

		forge-drawer .visible-in-fullscreen {
			display: none !important;
		}

		forge-bottom-sheet:not([fullscreen]) .visible-in-fullscreen {
			display: none !important;
		}

		forge-drawer .bottom-align-on-side {
			margin-bottom: -56px;
		}

		forge-bottom-sheet .bottom-align-on-side {
			margin-top: -56px;
		}
	</style>
</head>

<body class="forge-typography" style="display: block;">
	<forge-scaffold>
		<div slot="body" class="forge-center-container">
			<div id="app">
				<forge-text-field>
					<input type="text" id="keyboard-test-input" />
					<label for="keyboard-test-input" slot="label">Input to test keyboard interaction</label>
				</forge-text-field>
				<div class="card-container">
					<forge-card>
						<div class="forge-card-header-container">
							<h3 class="forge-typography--headline6">Standard Bottom Sheet</h3>
						</div>
						<div class="forge-typography--body2">
							<p>Standard bottom sheets co-exist with the screenâ€™s main UI
								region and allow for simultaneously viewing and interacting with both regions. They are
								commonly used to keep a feature or secondary content visible on screen when content in
								main UI region is frequently scrolled or panned.</p>
							<p>The Simple Bottom Sheet demo display a persistent, small,
								toast-like bottom sheet on any device/breakpoint.</p>
							<p>The Location Detail demo switches between a side drawer and
								a bottom sheet depending on the resolution. Can be put into fullscreen if the vertical
								resolution requires a scrollbar.</p>
							<p>The Scrollable Sheet uses the same template as the modal,
								but will display as a bottom sheet at all resolutions.</p>
						</div>

						<div class="forge-card-footer">
							<forge-button type="raised" id="show-standard-bottom-sheet-button">
								<button type="button">Simple Bottom Sheet</button>
							</forge-button>
							<forge-button type="raised" id="show-location-detail-sheet-button">
								<button type="button">Location Detail Style</button>
							</forge-button>
							<forge-button type="raised" id="show-standard-scrollable-sheet-button">
								<button type="button">Scrollable Sheet</button>
							</forge-button>
						</div>
					</forge-card>
					<forge-card>
						<div class="forge-card-header-container">
							<h3 class="forge-typography--headline6">Modal Bottom Sheet</h3>
						</div>
						<div class="forge-typography--body2">
							<p>Modal bottom sheets present a set of choices while blocking
								interaction
								with the rest of the screen. They are an alternative to inline menus and simple dialogs
								on
								mobile,
								providing additional room for content, iconography, and actions.

								Modal bottom sheets are used in mobile apps only.
							</p>

							<p>The Modal Bottom Sheet example demonstrates how the same
								template can be shared between a dialog at desktop resolutions or a bottom sheet on
								mobile. The bottom sheet can be made fullscreen by swipe/drag or scroll if the screen
								height forces a scrollbar at the time it is shown.
							</p>
						</div>

						<div class="forge-card-footer">
							<forge-button type="raised" id="show-modal-bottom-sheet-button">
								<button type="button">Modal Bottom Sheet</button>
							</forge-button>
						</div>
					</forge-card>
					<forge-card>
						<div class="forge-card-header-container">
							<h3 class="forge-typography--headline6">Expanding Bottom Sheet</h3>
						</div>
						<div class="forge-typography--body2">
							<p>An expanding bottom sheet is a surface anchored to the
								bottom
								of the
								screen that users can expand to access a feature or task. It can be used for:
							<ul>
								<li>Persistently displaying a cross-app feature, such as a shopping cart</li>
								<li>Collecting and acting on user selections from a set of items, such as photos in a
									gallery</li>
								<li>Supporting tasks, such as chat and comments</li>
								<li>Indirect navigation between items, such as videos in a playlist</li>
							</ul>
							Expanding bottom sheets are recommended for use on mobile and tablet.</p>

							<p>This is not currently supported by the existing bottom
								sheet component.
							</p>
						</div>
					</forge-card>
				</div>
			</div>
		</div>
		<forge-drawer id="side-sheet" slot="body-right" type="dismissable" direction="right" open="false">

		</forge-drawer>
		<template id="forge-modal-bottom-sheet-template">
			<header class="forge-dialog__header" forge-dialog-move-target>
				<h5 class="forge-dialog__title">Use location service?</h2>
			</header>
			<section class="forge-dialog__body" forge-bottom-sheet-body>
				<p>Let us determine your location to
					improve your search results. This means periodically sending anonymous location data
					to us.</p>
				<p>Let us determine your location to
					improve your search results. This means periodically sending anonymous location data
					to us.</p>
				<p>Let us determine your location to
					improve your search results. This means periodically sending anonymous location data
					to us.</p>
				<p>Let us determine your location to
					improve your search results. This means periodically sending anonymous location data
					to us.</p>
				<p>Let us determine your location to
					improve your search results. This means periodically sending anonymous location data
					to us.</p>
				<p>Let us determine your location to
					improve your search results. This means periodically sending anonymous location data
					to us.</p>
				<p>Let us determine your location to
					improve your search results. This means periodically sending anonymous location data
					to us.</p>
				<p>Let us determine your location to
					improve your search results. This means periodically sending anonymous location data
					to us.</p>
				<p>Let us determine your location to
					improve your search results. This means periodically sending anonymous location data
					to us.</p>
				<p>Let us determine your location to
					improve your search results. This means periodically sending anonymous location data
					to us.</p>
				<p>Let us determine your location to
					improve your search results. This means periodically sending anonymous location data
					to us.</p>
				<p>Let us determine your location to
					improve your search results. This means periodically sending anonymous location data
					to us.</p>
				<p>Let us determine your location to
					improve your search results. This means periodically sending anonymous location data
					to us.</p>
				<p>Let us determine your location to
					improve your search results. This means periodically sending anonymous location data
					to us.</p>
				<p>Let us determine your location to
					improve your search results. This means periodically sending anonymous location data
					to us.</p>
			</section>
			<footer class="forge-dialog__footer">
				<forge-button type="outlined">
					<button id="cancel-button">Disagree</button>
				</forge-button>
				<forge-button type="raised">
					<button id="accept-button" forge-dialog-focus>Agree</button>
				</forge-button>
			</footer>
		</template>
		<template id="forge-standard-bottom-sheet-template">
			<div style="display: flex; align-items: center; justify-content: space-between; padding: 8px;">
				Standard Bottom Sheet
				<forge-button type="outlined">
					<button id="close-button">Close</button>
				</forge-button>
			</div>
		</template>
		<template id="location-detail-template">
			<forge-toolbar>
				<div slot="start" style="display: flex; align-items: center;">
					<forge-icon-button class="visible-in-fullscreen">
						<button type="button" aria-label="Collapse" id="collapse-location-details-button">
							<forge-icon name="keyboard_arrow_down" external></forge-icon>
						</button>
					</forge-icon-button>
					<span class="forge-typography--headline5">Location Details</span>
				</div>
				<forge-fab slot="end" class="hidden-in-fullscreen bottom-align-on-side">
					<button aria-label="Default FAB">
						<i class="tyler-icons">favorite</i>
					</button>
				</forge-fab>
			</forge-toolbar>
			<div class="location-details-sheet__body" forge-bottom-sheet-body style="overflow-y: auto;">
				<forge-icon-button>
					<button type="button" aria-label="Call">
						<forge-icon name="call" external></forge-icon>
					</button>
				</forge-icon-button>
				<forge-icon-button>
					<button type="button" aria-label="Call">
						<forge-icon name="open_in_new" external></forge-icon>
					</button>
				</forge-icon-button>
				<forge-icon-button id="close-location-details-button">
					<button type="button" aria-label="Close">
						<forge-icon name="close" external></forge-icon>
					</button>
				</forge-icon-button>
				<forge-list>
					<forge-list-item>3794 Pretty View Lane</forge-list-item>
					<forge-list-item>Open</forge-list-item>
					<forge-list-item>thecornercafe.com</forge-list-item>
					<forge-list-item>(555) 555-1234</forge-list-item>
					<forge-list-item>Menu</forge-list-item>
					<forge-list-item>Add a Label</forge-list-item>
				</forge-list>
		</template>
	</forge-scaffold>

	<script type="text/javascript" src="../../dist/build/forge-lib.js"></script>
	<script type="text/javascript">
		Forge.lib.defineComponents();
		
		const modalBottomSheetTemplate = document.getElementById('forge-modal-bottom-sheet-template');
		const standardBottomSheetTemplate = document.getElementById('forge-standard-bottom-sheet-template');
		const locationDetailTemplate = document.getElementById('location-detail-template');

		const showBottomSheetButton = document.getElementById('show-modal-bottom-sheet-button');
		showBottomSheetButton.addEventListener('click', () => openModalBottomSheet());

		const showStandardButton = document.getElementById('show-standard-bottom-sheet-button');
		showStandardButton.addEventListener('click', () => openStandardBottomSheet());
		const showLocationDetailButton = document.getElementById('show-location-detail-sheet-button');
		showLocationDetailButton.addEventListener('click', () => openLocationDetailSheet());
		const showStandardScrollableSheet = document.getElementById('show-standard-scrollable-sheet-button');
		showStandardScrollableSheet.addEventListener('click', () => openModalBottomSheet(true));

		function openModalBottomSheet(nonModalOnDesktop) {
			const isMobile = nonModalOnDesktop || document.body.getBoundingClientRect().width < 800; // temp
			const dialogElement = document.createElement(isMobile ? 'forge-bottom-sheet' : 'forge-dialog');
			if (!nonModalOnDesktop) dialogElement.setAttribute('show-backdrop', 'true');

			// Load the template content and set that as the content for the dialog
			const content = modalBottomSheetTemplate.content.cloneNode(true);
			dialogElement.appendChild(content);

			// Listen for the `forge-dialog-close` event (by default it will fire if the backdrop is clicked or if the escape button is pressed)
			dialogElement.addEventListener(`forge-${isMobile ? 'bottom-sheet' : 'dialog'}-close`, (evt) => {
				console.log('close', evt);
			});


			// Handle the accept button being clicked	  
			const acceptButton = dialogElement.querySelector('#accept-button');
			acceptButton.addEventListener('click', () => {
				console.log('[bottom-sheet] Accept button clicked');
				dialogElement.open = false;
			});

			// test callback
			//   bottomSheetElement.beforeCloseCallback = () => false;
			// Handle the cancel button being clicked
			const cancelButton = dialogElement.querySelector('#cancel-button');
			cancelButton.addEventListener('click', () => dialogElement.open = false);

			// Shows the bottom sheet by appending it to the body and starting its animations
			dialogElement.open = true;
		}

		const events = [`forge-bottom-sheet-before-close`, `forge-bottom-sheet-close`, `forge-bottom-sheet-open`, `forge-bottom-sheet-ready`];
		function logEvents(bottomSheet) {
			events.forEach(eventType => bottomSheet.addEventListener(eventType, console.log));
		}

		function openStandardBottomSheet() {
			const bottomSheetElement = document.createElement('forge-bottom-sheet');

			const content = standardBottomSheetTemplate.content.cloneNode(true);
			bottomSheetElement.appendChild(content);
			logEvents(bottomSheetElement);

			const closeButton = bottomSheetElement.querySelector('#close-button');
			closeButton.addEventListener('click', () => bottomSheetElement.open = false);


			bottomSheetElement.open = true;
		}

		function openLocationDetailSheet() {
			const MOBILE_WIDTH = 600;
			let isMobile = window.innerWidth < MOBILE_WIDTH; // temp
			let sheet = isMobile ? document.createElement('forge-bottom-sheet') : document.querySelector('#side-sheet');

			// This is just a POC, not intended as a reference implementation 
			const onResize = (ev) => {
				if (isMobile && window.innerWidth >= MOBILE_WIDTH) {
					isMobile = false;
					sheet = document.querySelector('#side-sheet');
					sheet.replaceChildren(...document.querySelector('forge-bottom-sheet').children);
					document.querySelector('forge-bottom-sheet').open = false;
					sheet.open = true;
				} else if (!isMobile && window.innerWidth < MOBILE_WIDTH) {
					isMobile = true;
					document.querySelector('#side-sheet').open = false;
					sheet = document.createElement('forge-bottom-sheet');
					sheet.replaceChildren(...document.querySelector('#side-sheet').children);
					sheet.open = true;
				}
			};
			window.addEventListener('resize', onResize)

			const content = locationDetailTemplate.content.cloneNode(true);
			const result = sheet.appendChild(content);

			const closeButton = sheet.querySelector('#close-location-details-button');
			closeButton.addEventListener('click', () => {
				sheet.open = false;
				if (sheet.id === 'side-sheet')
					sheet.replaceChildren();
				window.removeEventListener('resize', onResize);
			});

			const collapseButton = sheet.querySelector('#collapse-location-details-button');
			collapseButton.addEventListener('click', () => { if (isMobile) sheet.fullscreen = false; });

			sheet.open = true;
		}
	</script>
</body>

</html>